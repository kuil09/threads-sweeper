<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Threads Sweeper</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="container">
    <header>
      <div class="header-content">
        <h1>🧹 Threads Sweeper</h1>
      </div>
    </header>

    <!-- Usage Guide -->
    <details class="usage-guide">
      <summary>📌 사용법 (클릭)</summary>
      <div class="guide-content">
        <p>1. <strong>수집:</strong> 상대방 프로필 페이지에서 팔로워 목록을 직접 연 뒤, [수집 시작]을 누르고 팔로워 목록을 스크롤합니다.</p>
        <p>2. <strong>대기열:</strong> 스크롤할수록 화면에 보이는 팔로워가 아래 차단 대기열에 자동으로 추가됩니다.</p>
        <p>3. <strong>차단:</strong> 대기열을 확인한 후 [차단 시작]을 눌러 백그라운드에서 차단을 실행합니다.</p>
        <p>4. <strong>수동:</strong> 여러 개의 계정을 공백 또는 쉼표(,)로 구분해 한 번에 입력한 뒤 [추가]를 누릅니다.</p>
        <p>5. <strong>동시 차단:</strong> 필요하다면 “동시 차단” 드롭다운에서 한 번에 처리할 계정 수(최대 10개)를 선택해 속도를 조절할 수 있습니다.</p>
        <p class="warning">⚠️ 차단 중에는 브라우저를 끄지 마세요.</p>
      </div>
    </details>

    <!-- SECTION: Source/Profile (Unified) -->
    <section id="source-section" class="section">
      <div id="source-status-card" class="profile-card">
        <!-- State 1: Disconnected / Not on Profile -->
        <div id="status-disconnected" class="status-content">
          <div class="status-icon">⚠️</div>
          <div class="status-message">
            <strong>프로필을 찾을 수 없습니다</strong>
            <span>Threads 프로필 페이지로 이동해 팔로워를 수집하세요.</span>
          </div>
        </div>

        <!-- State 2: Connected / On Profile -->
        <div id="status-connected" class="status-content hidden">
          <div class="profile-info-row">
            <div class="profile-text">
              <span class="profile-name" id="profile-name">-</span>
              <span class="profile-handle" id="profile-handle">-</span>
            </div>
            <button id="btn-collection-toggle" class="btn btn-primary btn-sm" style="width: auto; margin:0;">
              📥 수집 시작
            </button>
          </div>
          <p class="responsibility-text" style="font-size: 11px; margin-top: 8px; color: #888;">
            이 프로필에서 팔로워 목록을 먼저 연 뒤, [수집 시작]을 누르고 목록을 스크롤하면 화면에 보이는 팔로워들이 아래 차단 대기열에 추가됩니다.
          </p>
        </div>
      </div>
    </section>

    <!-- SECTION 3: Dashboard (Always Visible) -->
    <section id="dashboard-section" class="section">

      <!-- Manual Add -->
      <div class="input-group">
        <input type="text" id="manual-add-input" placeholder="차단할 계정 여러 개 입력 (@제외, 공백/쉼표 구분)">
        <button id="btn-manual-add" class="btn btn-secondary">추가</button>
      </div>

      <!-- List Container -->
      <div class="list-header"
      style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; margin-bottom: 5px;">
        <h3 style="margin: 0; font-size: 14px;">차단 대기열 (<span id="progress-current">0</span>/<span
            id="progress-total">0</span>)</h3>
        <div style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #666;">
          <label for="concurrency-select">동시 차단</label>
          <select id="concurrency-select" style="font-size: 11px; padding: 2px 4px;">
            <option value="1" selected>1개</option>
            <option value="2">2개</option>
            <option value="3">3개</option>
            <option value="4">4개</option>
            <option value="5">5개</option>
            <option value="6">6개</option>
            <option value="7">7개</option>
            <option value="8">8개</option>
            <option value="9">9개</option>
            <option value="10">10개</option>
          </select>
          <button id="btn-export-csv" class="text-btn">CSV 저장</button>
        </div>
      </div>

      <p style="margin: 4px 0 8px 0; font-size: 11px; color: #888;">
        팔로워 목록을 연 뒤 아래로 스크롤하면 화면에 보이는 계정이 이 목록에 자동으로 추가됩니다.
      </p>

      <div id="user-list-container">
        <!-- Users injected here -->
        <div class="empty-state">대상이 없습니다.</div>
      </div>

      <!-- Action Controls -->
      <!-- Action Controls -->
      <!-- Blocking Controls -->
      <div id="blocking-controls" class="action-controls">
        <button id="btn-blocking-toggle" class="btn btn-danger">차단 시작</button>
      </div>

      <!-- Collection Controls removed - unified with profile card button -->

      <!-- Footer Actions (Reset) -->
      <div class="footer-actions">
        <button id="btn-reset" class="btn btn-text reset-btn">↻ 초기화</button>
      </div>
    </section>

  </div>

  <script src="popup.js" type="module"></script>
</body>

</html>